"use strict";function vast2html5(e,t){var i,a=document.getElementById(t),n=a.getAttribute("width")+"x"+a.getAttribute("height"),r=readVAST(e),s=document.createElement("source"),d=document.createElement("img");d.width="1px",d.height="1px",d.style.display="none",d.src=r.impression,d.id="events-"+t,document.body.appendChild(d);var o=document.getElementById("events-"+t);if(n in vast_obj.creative[0].medias){var l=vast_obj.creative[0].medias[n];for(var m in l){if(formats.indexOf(m)<0)break;s.src=l[m].url,s.type="video/"+m,a.appendChild(s)}}i=vast_obj.creative[0].trackingEvents,a.addEventListener("play",function(e){o.setAttribute("src",i.start)},!1),a.addEventListener("pause",function(e){o.setAttribute("src",i.pause)},!1),a.addEventListener("ended",function(e){o.setAttribute("src",i.complete)},!1),a.addEventListener("volumechange",function(e){0==a.volume?o.setAttribute("src",i.start):!1},!1)}function readVAST(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.onload=function(){t.status>=200&&t.status<400&&(resp=makeObject(t.responseXML))},t.send(),resp}function isEmpty(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function makeObject(e){adSystem=e.getElementsByTagName("AdSystem")[0],null!=adSystem&&(vast_obj.adSystem=adSystem.childNodes[0].nodeValue),adTitle=e.getElementsByTagName("AdTitle")[0],null!=adTitle&&(vast_obj.adTitle=adTitle.childNodes[0].nodeValue),impression=e.getElementsByTagName("Impression")[0],null!=impression&&(vast_obj.impression=impression.childNodes[0].nodeValue),Creative=e.getElementsByTagName("Creative");for(var t=0;t<Creative.length;t++)if(item=Creative[t].getElementsByTagName("Linear"),null!=item){if(creative=vast_obj.creative[t]={},vast_obj.creative[t].trackingEvents={},vast_obj.creative[t].medias={},duration=item[t].getElementsByTagName("Duration")[0],null!=duration){creative.duration=duration.childNodes[0].nodeValue;var i=creative.duration.split(":");duration=60*i[0]*60+60*i[1]+i[2],creative.durationSeconds=duration}if(videoClick=item[t].getElementsByTagName("ClickThrough"),null!=videoClick&&(creative.click=videoClick[0].childNodes[0].nodeValue),trackingEvents=item[t].getElementsByTagName("Tracking"),null!=trackingEvents)for(var a=0;a<trackingEvents.length;a++)evt=trackingEvents[a],creative.trackingEvents[evt.getAttribute("event")]=evt.childNodes[0].nodeValue;if(mediaFiles=item[t].getElementsByTagName("MediaFile"),null!=mediaFiles)for(var a=0;a<mediaFiles.length;a++){mediaTag=mediaFiles[a];var n=mediaTag.getAttribute("width")+"x"+mediaTag.getAttribute("height");creative.medias[n]=isEmpty(creative.medias[n])?{}:creative.medias[n];var r=mediaTag.getAttribute("type").split("/").slice(-1)[0];creative.medias[n][r]={},creative.medias[n][r].url=mediaTag.childNodes[0].nodeValue}}return vast_obj}var formats=["mp4","webm","ogg"],vast_obj={},adSystem,adTitle,impression,Creative,item,creative,duration,videoClick,mediaFiles,mediaTag,trackingEvents,evt,resp;vast_obj.creative=[];